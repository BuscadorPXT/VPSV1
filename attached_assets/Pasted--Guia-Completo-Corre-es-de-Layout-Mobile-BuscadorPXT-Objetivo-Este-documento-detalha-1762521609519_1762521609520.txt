# üì± Guia Completo: Corre√ß√µes de Layout Mobile - BuscadorPXT

> **Objetivo:** Este documento detalha todas as corre√ß√µes de layout mobile aplicadas no projeto BuscadorPXT.
> Use como refer√™ncia para replicar as mesmas corre√ß√µes em outros ambientes.

**Data:** 2025-11-07
**Vers√£o:** 1.0
**Stack:** React 18 + TypeScript 5.6 + Tailwind CSS + shadcn/ui

---

## üìã √çndice de Corre√ß√µes

1. [Dialog Component - Overflow em Mobile](#1-dialog-component---overflow-em-mobile)
2. [Sheet Component - Safe Areas iOS](#2-sheet-component---safe-areas-ios)
3. [MobileSearchBar - Busca por N√∫meros](#3-mobilesearchbar---busca-por-n√∫meros)
4. [TopSearchBar - Expans√£o Inteligente](#4-topsearchbar---expans√£o-inteligente)
5. [Landing Page - Menu Mobile](#5-landing-page---menu-mobile)
6. [Sidebar - Modo Colapsado](#6-sidebar---modo-colapsado)
7. [Dashboard Layout - Transi√ß√£o Suave](#7-dashboard-layout---transi√ß√£o-suave)
8. [CSS Global - Utility Classes](#8-css-global---utility-classes)
9. [Mobile Header - Touch Targets](#9-mobile-header---touch-targets)

---

## 1. Dialog Component - Overflow em Mobile

### üêõ Problema
Di√°logos ultrapassavam o viewport em telas mobile (< 500px), causando:
- Scroll horizontal indesejado
- Conte√∫do cortado nas laterais
- Bot√£o X dif√≠cil de tocar (< 44px)

### üìÅ Arquivo
```
client/src/components/ui/dialog.tsx
```

### üîß Solu√ß√£o

#### ANTES:
```tsx
const DialogContent = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>
>(({ className, children, ...props }, ref) => (
  <DialogPortal>
    <DialogOverlay />
    <DialogPrimitive.Content
      ref={ref}
      className={cn(
        'fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg',
        className
      )}
      {...props}
    >
      {children}
      <DialogPrimitive.Close className="absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground">
        <X className="h-4 w-4" />
        <span className="sr-only">Close</span>
      </DialogPrimitive.Close>
    </DialogPrimitive.Content>
  </DialogPortal>
))
```

#### DEPOIS:
```tsx
const DialogContent = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>
>(({ className, children, ...props }, ref) => (
  <DialogPortal>
    <DialogOverlay />
    <DialogPrimitive.Content
      ref={ref}
      className={cn(
        // ‚¨áÔ∏è MUDAN√áA 1: Largura responsiva
        'fixed left-[50%] top-[50%] z-50 grid w-full max-w-[calc(100vw-2rem)] sm:max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-4 sm:p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg',
        // ‚¨ÜÔ∏è MUDAN√áA 2: Padding responsivo p-4 sm:p-6
        className
      )}
      {...props}
    >
      {children}
      {/* ‚¨áÔ∏è MUDAN√áA 3: Touch target 44x44px e posi√ß√£o responsiva */}
      <DialogPrimitive.Close className="absolute right-2 top-2 sm:right-4 sm:top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground min-h-[44px] min-w-[44px] inline-flex items-center justify-center">
        <X className="h-4 w-4" />
        <span className="sr-only">Close</span>
      </DialogPrimitive.Close>
    </DialogPrimitive.Content>
  </DialogPortal>
))
```

### üìù Mudan√ßas Espec√≠ficas:

1. **Largura m√°xima mobile:**
   ```diff
   - max-w-lg
   + max-w-[calc(100vw-2rem)] sm:max-w-lg
   ```
   - **Motivo:** `calc(100vw-2rem)` garante margem de 1rem (16px) em cada lado
   - **Breakpoint:** `sm:` (640px) volta ao tamanho original

2. **Padding responsivo:**
   ```diff
   - p-6
   + p-4 sm:p-6
   ```
   - **Mobile:** 16px de padding (economiza espa√ßo)
   - **Desktop:** 24px de padding (conforto visual)

3. **Bot√£o Close:**
   ```diff
   - className="absolute right-4 top-4 ..."
   + className="absolute right-2 top-2 sm:right-4 sm:top-4 ... min-h-[44px] min-w-[44px] inline-flex items-center justify-center"
   ```
   - **Touch target:** 44x44px (Apple HIG guideline)
   - **Posi√ß√£o mobile:** 8px das bordas (right-2 top-2)
   - **Posi√ß√£o desktop:** 16px das bordas (right-4 top-4)

### ‚úÖ Valida√ß√£o
```bash
# Testar em viewports:
- 320px (iPhone SE) ‚Üí Dialog tem 288px largura (320 - 32)
- 375px (iPhone 12) ‚Üí Dialog tem 343px largura (375 - 32)
- 640px+ (Desktop) ‚Üí Dialog volta para max-w-lg (512px)

# Verificar:
‚úì Sem scroll horizontal
‚úì Bot√£o X toc√°vel com polegar
‚úì Conte√∫do n√£o cortado
```

---

## 2. Sheet Component - Safe Areas iOS

### üêõ Problema
Sheets (drawer lateral/bottom) n√£o respeitavam safe areas do iOS (notch, navigation bar), causando:
- Conte√∫do sobreposto pelo notch
- Bot√£o home do iOS cobrindo conte√∫do inferior

### üìÅ Arquivo
```
client/src/components/ui/sheet.tsx
```

### üîß Solu√ß√£o

#### ANTES:
```tsx
const sheetVariants = cva(
  'fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500',
  {
    variants: {
      side: {
        top: 'inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top',
        bottom:
          'inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom',
        left: 'inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm',
        right:
          'inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm',
      },
    },
    defaultVariants: {
      side: 'right',
    },
  }
)
```

#### DEPOIS:
```tsx
const sheetVariants = cva(
  // ‚¨áÔ∏è MUDAN√áA 1: Padding responsivo
  'fixed z-50 gap-4 bg-background p-4 sm:p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500',
  {
    variants: {
      side: {
        // ‚¨áÔ∏è MUDAN√áA 2: Safe area top
        top: 'inset-x-0 top-0 border-b pt-[env(safe-area-inset-top)] data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top',
        // ‚¨áÔ∏è MUDAN√áA 3: Safe area bottom
        bottom:
          'inset-x-0 bottom-0 border-t pb-[env(safe-area-inset-bottom)] data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom',
        left: 'inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm',
        right:
          'inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm',
      },
    },
    defaultVariants: {
      side: 'right',
    },
  }
)
```

#### Close Button:
```tsx
// ANTES:
<SheetPrimitive.Close className="absolute right-4 top-4 rounded-sm opacity-70 ...">

// DEPOIS:
<SheetPrimitive.Close className="absolute right-2 top-2 sm:right-4 sm:top-4 rounded-sm opacity-70 ... min-h-[44px] min-w-[44px] inline-flex items-center justify-center">
```

### üìù Mudan√ßas Espec√≠ficas:

1. **Safe area top:**
   ```css
   pt-[env(safe-area-inset-top)]
   ```
   - Adiciona padding din√¢mico para notch do iPhone (varia por modelo)

2. **Safe area bottom:**
   ```css
   pb-[env(safe-area-inset-bottom)]
   ```
   - Adiciona padding para home indicator do iOS

3. **Padding responsivo:**
   ```diff
   - p-6
   + p-4 sm:p-6
   ```

4. **Touch target no close button:**
   - Mesmo padr√£o do Dialog (44x44px)

### ‚úÖ Valida√ß√£o
```bash
# Testar em dispositivos iOS reais ou simulador:
- iPhone 14 Pro (Dynamic Island) ‚Üí Conte√∫do n√£o sobreposto
- iPhone SE (sem notch) ‚Üí Funciona normalmente
- iPad ‚Üí Sem mudan√ßas (n√£o tem notch)

# CSS env() retorna 0 em devices sem safe areas
```

---

## 3. MobileSearchBar - Busca por N√∫meros

### üêõ Problema
Buscar "15" n√£o mostrava "iPhone 15 Pro Max", apenas resultados com match exato "15".
Usu√°rios precisavam digitar "iPhone 15" completo.

### üìÅ Arquivo
```
client/src/components/MobileSearchBar.tsx
```

### üîß Solu√ß√£o

#### MUDAN√áA 1: Detectar query num√©rica (linha ~125)

```tsx
// ‚¨áÔ∏è ADICIONAR: Detector de n√∫meros simples
const isNumberQuery = /^\d{1,2}$/.test(query.trim());

const params = new URLSearchParams({
  q: query,
  // ‚¨áÔ∏è MUDAN√áA: Mais resultados para n√∫meros, menos para texto
  limit: isNumberQuery ? '12' : '6',
  // ‚¨áÔ∏è MUDAN√áA: N√£o usar exact match em n√∫meros (backend expande)
  ...(isNumberQuery ? {} : { exact: 'true' }),
});
```

**L√≥gica:**
- Regex `/^\d{1,2}$/` detecta 1 ou 2 d√≠gitos soltos (ex: "5", "15", "14")
- N√∫meros: 12 resultados, sem `exact=true` (backend filtra variantes)
- Texto: 6 resultados, com `exact=true` (match preciso)

#### MUDAN√áA 2: Filtrar resultados localmente (linha ~147)

```tsx
const data = await response.json();
const queryLower = query.toLowerCase().trim();

// ‚¨áÔ∏è ADICIONAR: Detec√ß√£o de query num√©rica
const isNumberQuery = /^\d{1,2}$/.test(query.trim());

// ‚¨áÔ∏è MUDAN√áA: Para n√∫meros, usar resultados do backend diretamente
const inclusiveSuggestions = isNumberQuery
  ? (data.suggestions || []) // Backend j√° filtrou
  : (data.suggestions || []).filter((suggestion: any) => {
      // L√≥gica de filtro existente para texto
      const suggestionValue = typeof suggestion === 'string' ? suggestion : suggestion.value;
      let cleanValue = suggestionValue;

      // Extrair modelo e contagem do formato "iPhone 15 (5 produtos)"
      const match = suggestionValue.match(/^(.+?)\s*\((\d+)\s+produtos?\)$/);
      if (match) {
        cleanValue = match[1].trim();
      }

      const valueLower = cleanValue.toLowerCase().trim();
      const queryLower = query.toLowerCase().trim();

      // Busca super inclusiva desde a primeira letra
      return (
        valueLower.includes(queryLower) ||
        valueLower.startsWith(queryLower) ||
        valueLower
          .split(' ')
          .some((word) => word.startsWith(queryLower) || word.includes(queryLower)) ||
        valueLower.replace(/[^a-z0-9]/g, '').includes(queryLower.replace(/[^a-z0-9]/g, ''))
      );
    });
```

**L√≥gica:**
- Se query num√©rica: confiar no backend (que faz expans√£o inteligente)
- Se query texto: fazer filtro inclusivo no frontend

### üìù Resumo das Mudan√ßas:

```typescript
// PADR√ÉO A SEGUIR:

// 1. Detectar query num√©rica
const isNumberQuery = /^\d{1,2}$/.test(query.trim());

// 2. Ajustar par√¢metros de API
const params = {
  q: query,
  limit: isNumberQuery ? '12' : '6',
  ...(isNumberQuery ? {} : { exact: 'true' })
};

// 3. Processar resultados
const suggestions = isNumberQuery
  ? data.suggestions  // Usar direto do backend
  : data.suggestions.filter(/* l√≥gica de filtro */);
```

### ‚úÖ Valida√ß√£o
```bash
# Teste 1: Buscar "15"
Esperado:
1. iPhone 15
2. iPhone 15 Pro
3. iPhone 15 Pro Max
4. iPhone 15 Plus

# Teste 2: Buscar "iphone"
Esperado:
1-6 modelos mais relevantes com "iphone"

# Teste 3: Buscar "14"
Esperado:
- iPhone 14 (todas variantes)
- MacBook Pro 14" (se houver)
```

---

## 4. TopSearchBar - Expans√£o Inteligente

### üêõ Problema
Mesma limita√ß√£o do MobileSearchBar, mas em desktop. Busca desktop n√£o expandia n√∫meros.

### üìÅ Arquivo
```
client/src/components/top-search-bar.tsx
```

### üîß Solu√ß√£o

#### MUDAN√áA 1: Adicionar fun√ß√µes auxiliares (linha ~359)

```tsx
// ‚¨áÔ∏è ADICIONAR: Fun√ß√£o para detectar n√∫mero simples
const isSimpleNumberQuery = (query: string): boolean => {
  return /^\d{1,2}$/.test(query.trim());
};

// ‚¨áÔ∏è ADICIONAR: Fun√ß√£o para expandir n√∫mero para variantes
const expandNumberQuery = (query: string, models: string[]): string[] => {
  const queryNum = query.trim();
  const results: string[] = [];

  // Procurar todos produtos que cont√™m esse n√∫mero
  models.forEach(model => {
    if (typeof model === 'string') {
      const modelLower = model.toLowerCase();

      // Tratamento especial para iPhone
      if (modelLower.includes('iphone')) {
        // Match padr√µes: "iPhone 15", "iPhone 15 Pro", etc.
        const iphonePattern = new RegExp(`iphone\\s+${queryNum}(?:\\s|$|\\s+pro|\\s+plus|\\s+max|\\s+mini)`, 'i');
        if (iphonePattern.test(model)) {
          results.push(model);
        }
      }
      // Para outros produtos (MacBook, iPad, etc.)
      else if (modelLower.includes(queryNum)) {
        // Verificar se n√∫mero aparece como palavra distinta (n√£o parte de outro n√∫mero)
        const numberPattern = new RegExp(`\\b${queryNum}\\b`);
        if (numberPattern.test(modelLower)) {
          results.push(model);
        }
      }
    }
  });

  // Ordenar resultados inteligentemente
  return results.sort((a, b) => {
    const aLower = a.toLowerCase();
    const bLower = b.toLowerCase();

    // Base models primeiro (sem Pro/Max/Plus)
    const aIsBase = !/(pro|max|plus|mini)/i.test(a);
    const bIsBase = !/(pro|max|plus|mini)/i.test(b);

    if (aIsBase && !bIsBase) return -1;
    if (!aIsBase && bIsBase) return 1;

    // Ordenar por hierarquia de variantes: Pro, Pro Max, Plus, Mini
    const variantOrder = ['pro max', 'pro', 'plus', 'mini'];
    const aVariantIndex = variantOrder.findIndex(v => aLower.includes(v));
    const bVariantIndex = variantOrder.findIndex(v => bLower.includes(v));

    if (aVariantIndex !== -1 && bVariantIndex !== -1) {
      return aVariantIndex - bVariantIndex;
    }

    return a.localeCompare(b);
  });
};
```

#### MUDAN√áA 2: Usar fun√ß√µes na busca (linha ~479)

```tsx
const performSearch = useCallback(
  async (query: string) => {
    // ... c√≥digo existente ...

    // ‚¨áÔ∏è ADICIONAR: Usar expans√£o de n√∫meros
    let filtered: string[] = [];

    if (isSimpleNumberQuery(query)) {
      console.log('üî¢ Detected simple number query:', query);
      filtered = expandNumberQuery(query, modelsToSearch);
      console.log('üî¢ Expanded to variants:', filtered);
    } else {
      // L√≥gica de filtro existente para texto
      filtered = modelsToSearch
        .filter((model) => {
          // ... filtro existente ...
        })
        .sort((a, b) => {
          // ... ordena√ß√£o existente ...
        });
    }

    // Slice e map resultados
    const suggestions = filtered
      .slice(0, query.length === 1 ? 25 : 20)
      .map((model) => ({ value: model, type: 'model' }));

    // ... resto do c√≥digo ...
  },
  [/* deps */]
);
```

#### MUDAN√áA 3: Ajustar chamada de API (linha ~574)

```tsx
// ‚¨áÔ∏è ADICIONAR: Detectar query num√©rica para API
const isNumberQuery = /^\d{1,2}$/.test(query.trim());
const exactParam = isNumberQuery ? '' : '&exact=true';

const response = await fetch(
  `/api/search/suggestions?q=${encodeURIComponent(query)}&limit=15${exactParam}`,
  { headers, signal: abortControllerRef.current.signal }
);
```

### üìù Resumo das Mudan√ßas:

1. **Fun√ß√£o `isSimpleNumberQuery`:** Detecta queries de 1-2 d√≠gitos
2. **Fun√ß√£o `expandNumberQuery`:** Expande n√∫mero para todas variantes
3. **L√≥gica de ordena√ß√£o:** Base ‚Üí Pro ‚Üí Pro Max ‚Üí Plus ‚Üí Mini
4. **Integra√ß√£o com API:** N√£o envia `exact=true` para n√∫meros

### ‚úÖ Valida√ß√£o
```bash
# Deve ter comportamento id√™ntico ao MobileSearchBar
# Testar em desktop (>= 640px)
```

---

## 5. Landing Page - Menu Mobile

### üêõ Problema
Landing page n√£o tinha menu mobile funcional. Usu√°rios em mobile n√£o conseguiam navegar.

### üìÅ Arquivo
```
client/src/pages/landing.tsx
```

### üîß Solu√ß√£o

#### MUDAN√áA 1: Adicionar estado do menu (linha ~18)

```tsx
export default function LandingPage() {
  const [isLoaded, setIsLoaded] = useState(false);
  const [isScrolled, setIsScrolled] = useState(false);
  // ‚¨áÔ∏è ADICIONAR: Estado do menu mobile
  const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);
```

#### MUDAN√áA 2: Adicionar bot√£o hamburguer (linha ~174)

```tsx
<div className="flex gap-3 items-center">
  {/* ‚¨áÔ∏è ADICIONAR: Bot√£o hamburguer mobile */}
  <button
    onClick={() => setIsMobileMenuOpen(!isMobileMenuOpen)}
    className="md:hidden p-2 rounded-md hover:bg-white/10 transition-colors"
    aria-label="Menu"
  >
    {isMobileMenuOpen ? <X className="h-6 w-6" /> : <Menu className="h-6 w-6" />}
  </button>

  {/* Desktop Login Button */}
  <Link href="/login" className="hidden md:block">
    <Button variant="ghost" size="sm" ...>
      Entrar
    </Button>
  </Link>

  {/* Desktop CTA Button */}
  <button className="hidden md:inline-flex ...">
    Come√ßar
  </button>
</div>
```

**Importar √≠cones:**
```tsx
import { Menu, X } from 'lucide-react';
```

#### MUDAN√áA 3: Adicionar drawer do menu (linha ~226)

```tsx
{/* ‚¨áÔ∏è ADICIONAR: Menu Mobile */}
{isMobileMenuOpen && (
  <>
    {/* Overlay */}
    <div
      className="fixed inset-0 bg-black/80 z-40 md:hidden"
      onClick={() => setIsMobileMenuOpen(false)}
    />

    {/* Menu Drawer */}
    <div className="fixed top-[64px] right-0 bottom-0 w-[280px] bg-black/95 backdrop-blur-xl border-l border-white/10 z-50 md:hidden">
      <nav className="flex flex-col p-6 space-y-6">
        {/* Navigation Links */}
        <button
          onClick={() => {
            scrollToSection('como-funciona');
            setIsMobileMenuOpen(false);
          }}
          className="text-left text-base font-medium text-zinc-300 hover:text-white transition-colors py-2"
        >
          Como funciona
        </button>
        <button
          onClick={() => {
            scrollToSection('recursos');
            setIsMobileMenuOpen(false);
          }}
          className="text-left text-base font-medium text-zinc-300 hover:text-white transition-colors py-2"
        >
          Recursos
        </button>
        <button
          onClick={() => {
            scrollToSection('pricing');
            setIsMobileMenuOpen(false);
          }}
          className="text-left text-base font-medium text-zinc-300 hover:text-white transition-colors py-2"
        >
          Pre√ßos
        </button>

        {/* Divider */}
        <div className="border-t border-white/10" />

        {/* Action Buttons */}
        <Link href="/login" onClick={() => setIsMobileMenuOpen(false)}>
          <Button variant="ghost" size="sm" className="w-full justify-start text-zinc-300 hover:text-white transition-colors">
            Entrar
          </Button>
        </Link>

        <button
          className="w-full group relative inline-flex cursor-pointer transition-all duration-300 hover:scale-[1.02] hover:text-white font-semibold text-white/70 tracking-tight rounded-full py-3 px-4 items-center justify-center"
          style={{
            boxShadow: 'inset 0 0 0 1px rgba(255,255,255,0.1)',
            background: 'radial-gradient(ellipse at bottom,rgba(71,81,92,1) 0%,rgba(0,0,0,1) 100%)',
          }}
          onClick={() => {
            setIsMobileMenuOpen(false);
            trackMetaEvent('Contact', {
              content_name: 'WhatsApp Contact - Mobile Menu',
              method: 'whatsapp',
            });
            const message = encodeURIComponent(
              'Ol√°! Gostaria de conhecer o sistema Buscador PXT e saber como posso come√ßar a usar.'
            );
            window.open(`https://wa.me/5511963232465?text=${message}`, '_blank');
          }}
        >
          <span className="relative z-10 font-normal">Come√ßar</span>
        </button>
      </nav>
    </div>
  </>
)}
```

#### MUDAN√áA 4: Ajustar background effects (linha ~107)

```tsx
{/* Background Effects */}
<div className="pointer-events-none fixed inset-0 overflow-hidden">
  {/* ‚¨áÔ∏è MUDAN√áA: Tamanhos responsivos para n√£o vazar em mobile */}
  <div className="absolute -top-40 left-1/2 -translate-x-1/2 w-[150vw] h-[150vw] sm:w-[1200px] sm:h-[1200px] rounded-full blur-3xl opacity-30 bg-[radial-gradient(closest-side,rgba(29,78,216,0.4),rgba(0,0,0,0))]"></div>
  <div className="absolute bottom-0 right-0 w-[100vw] h-[100vw] sm:w-[800px] sm:h-[800px] translate-x-1/3 translate-y-1/3 rounded-full blur-3xl opacity-25 bg-[radial-gradient(closest-side,rgba(147,51,234,0.35),rgba(0,0,0,0))]"></div>
  <div className="absolute top-1/2 left-0 w-[80vw] h-[80vw] sm:w-[600px] sm:h-[600px] -translate-x-1/3 -translate-y-1/2 rounded-full blur-3xl opacity-20 bg-[radial-gradient(closest-side,rgba(6,182,212,0.3),rgba(0,0,0,0))]"></div>
</div>
```

### üìù Resumo das Mudan√ßas:

1. **Bot√£o hamburguer:** Menu/X toggle
2. **Drawer lateral:** 280px de largura, overlay escuro
3. **Auto-close:** Fechar ao clicar em links
4. **Background effects:** Tamanhos responsivos com viewport units

### ‚úÖ Valida√ß√£o
```bash
# Mobile (< 768px):
‚úì Bot√£o hamburguer vis√≠vel
‚úì Clicar abre drawer da direita
‚úì Overlay escurece o fundo
‚úì Links funcionam e fecham menu
‚úì CTA "Come√ßar" funciona

# Desktop (>= 768px):
‚úì Menu inline vis√≠vel
‚úì Bot√£o hamburguer oculto
‚úì Comportamento normal
```

---

## 6. Sidebar - Modo Colapsado

### üêõ Problema
Sidebar colapsada tinha √≠cones pequenos demais (16x16px) para tocar em mobile/touch devices.

### üìÅ Arquivo
```
client/src/components/sidebar.tsx
```

### üîß Solu√ß√£o

#### MUDAN√áA 1: Props do componente (linha ~42)

```tsx
interface SidebarProps {
  isOpen: boolean;
  onToggle: () => void;
  // ‚¨áÔ∏è ADICIONAR: Props para controle de collapsed
  isCollapsed?: boolean;
  onCollapsedChange?: (collapsed: boolean) => void;
}

export function Sidebar({
  isOpen,
  onToggle,
  isCollapsed,
  onCollapsedChange
}: SidebarProps) {
  // ‚¨áÔ∏è MUDAN√áA: Usar controlled state se fornecido
  const [internalSidebarCollapsed, setInternalSidebarCollapsed] = useState(false);

  const sidebarCollapsed = isCollapsed !== undefined ? isCollapsed : internalSidebarCollapsed;
  const setSidebarCollapsed = onCollapsedChange || setInternalSidebarCollapsed;
```

#### MUDAN√áA 2: Tamanhos de √≠cones responsivos (aplicar em TODOS itens)

```tsx
// PADR√ÉO PARA ITENS DE NAVEGA√á√ÉO:

<div
  className={`relative flex items-center ${sidebarCollapsed ? 'justify-center' : 'justify-between'}
  ${sidebarCollapsed ? 'px-0 py-3' : 'px-3 py-2'}
  rounded-md text-sm font-medium transition-all duration-200 cursor-pointer min-h-[44px] ...`}
>
  <div className={`flex items-center ${sidebarCollapsed ? '' : 'space-x-3'}`}>
    {/* ‚¨áÔ∏è MUDAN√áA: √çcones maiores quando colapsada */}
    <IconComponent
      className={`${sidebarCollapsed ? 'h-5 w-5' : 'h-4 w-4'}
      ${item.active ? 'text-primary' : ''}
      transition-all duration-200`}
    />
    {!sidebarCollapsed && (
      <span className={item.active ? 'font-semibold' : ''}>{item.name}</span>
    )}
  </div>
</div>
```

#### MUDAN√áA 3: Logo responsivo (linha ~304)

```tsx
<div className={`flex items-center ${sidebarCollapsed ? 'justify-center w-full' : ''}`}>
  <div
    className={`${sidebarCollapsed ? 'h-12 sm:h-16 w-12 sm:w-16' : 'h-20 sm:h-32 w-20 sm:w-32'}
    rounded-lg flex items-center justify-center overflow-hidden flex-shrink-0`}
  >
    <img src={logoBranca} alt="Logo" className="h-full w-full object-contain" />
  </div>
</div>
```

#### MUDAN√áA 4: Bot√£o expand otimizado (linha ~343)

```tsx
{sidebarCollapsed && (
  <div className="flex justify-center mt-2 mb-2">
    <button
      onClick={() => setSidebarCollapsed(!sidebarCollapsed)}
      className="p-2 rounded-md hover:bg-primary/10 hover:text-primary transition-all duration-200"
    >
      {/* ‚¨áÔ∏è MUDAN√áA: √çcone maior */}
      <ChevronRight className="h-5 w-5 transition-transform duration-300" />
    </button>
  </div>
)}
```

#### MUDAN√áA 5: Z-index corrigido (linha ~761)

```tsx
<aside
  className={`fixed left-0 top-0 bottom-0 hidden lg:flex lg:flex-shrink-0 transition-all duration-300 z-30 ${
    sidebarCollapsed ? 'lg:w-16' : 'lg:w-64'
  }`}
>
```

**Antes:** `z-1` (muito baixo)
**Depois:** `z-30` (evita sobreposi√ß√£o)

### üìù Resumo das Mudan√ßas:

| Estado | Logo | √çcones | Padding | Touch Target |
|--------|------|--------|---------|--------------|
| **Expandida** | 128x128px | 16x16px | px-3 py-2 | Normal |
| **Colapsada Mobile** | 48x48px | 20x20px | px-0 py-3 | 44x44px |
| **Colapsada Desktop** | 64x64px | 20x20px | px-0 py-3 | 44x44px |

### ‚úÖ Valida√ß√£o
```bash
# Sidebar colapsada:
‚úì √çcones vis√≠veis 20x20px
‚úì √Årea de toque >= 44x44px
‚úì Hover funciona em toda √°rea
‚úì Tooltip mostra nome do item

# Sidebar expandida:
‚úì Comportamento normal
‚úì Transi√ß√£o suave (300ms)
```

---

## 7. Dashboard Layout - Transi√ß√£o Suave

### üêõ Problema
Main content n√£o se ajustava quando sidebar colapsava, causando overlap.

### üìÅ Arquivo
```
client/src/components/dashboard-layout.tsx
```

### üîß Solu√ß√£o

#### MUDAN√áA 1: Estado de collapsed (linha ~118)

```tsx
export const DashboardLayout = React.memo(({ children, dateFilter }: DashboardLayoutProps) => {
  const [sidebarOpen, setSidebarOpen] = useState(false);
  // ‚¨áÔ∏è ADICIONAR: Estado de collapsed
  const [sidebarCollapsed, setSidebarCollapsed] = useState(false);
```

#### MUDAN√áA 2: Passar props para Sidebar (linha ~192)

```tsx
<Sidebar
  isOpen={sidebarOpen}
  onToggle={toggleSidebar}
  // ‚¨áÔ∏è ADICIONAR: Props de collapsed
  isCollapsed={sidebarCollapsed}
  onCollapsedChange={setSidebarCollapsed}
/>
```

#### MUDAN√áA 3: Main content responsivo (linha ~205)

```tsx
{/* ‚¨áÔ∏è MUDAN√áA: Margin-left din√¢mico baseado em collapsed */}
<main className={`flex-1 overflow-hidden transition-all duration-300
  ${sidebarCollapsed ? 'lg:ml-16' : 'lg:ml-64'}`}
>
  <div className="h-full overflow-y-auto">{children}</div>
</main>
```

**L√≥gica:**
- Sidebar colapsada: `ml-16` (64px)
- Sidebar expandida: `ml-64` (256px)
- Transi√ß√£o suave: `transition-all duration-300`

### ‚úÖ Valida√ß√£o
```bash
# Clicar no bot√£o de collapse:
‚úì Sidebar anima para 64px
‚úì Main content desliza para direita (ml-16)
‚úì Sem overlap de conte√∫do
‚úì Transi√ß√£o sincronizada (300ms)
```

---

## 8. CSS Global - Utility Classes

### üêõ Problema
Classes do shadcn/ui n√£o estavam dispon√≠veis, causando estilos quebrados.

### üìÅ Arquivo
```
client/src/index.css
```

### üîß Solu√ß√£o

#### ADICIONAR: Utility layer (ap√≥s linha ~498)

```css
@tailwind base;
@tailwind components;
@tailwind utilities;

/* ‚¨áÔ∏è ADICIONAR: Utility classes para tema */
@layer utilities {
  /* Background Colors */
  .bg-background {
    background-color: hsl(var(--background));
  }
  .text-foreground {
    color: hsl(var(--foreground));
  }
  .bg-card {
    background-color: hsl(var(--card));
  }
  .text-card-foreground {
    color: hsl(var(--card-foreground));
  }
  .bg-primary {
    background-color: hsl(var(--primary));
  }
  .text-primary-foreground {
    color: hsl(var(--primary-foreground));
  }
  .bg-secondary {
    background-color: hsl(var(--secondary));
  }
  .text-secondary-foreground {
    color: hsl(var(--secondary-foreground));
  }
  .bg-muted {
    background-color: hsl(var(--muted));
  }
  .text-muted-foreground {
    color: hsl(var(--muted-foreground));
  }
  .bg-accent {
    background-color: hsl(var(--accent));
  }
  .text-accent-foreground {
    color: hsl(var(--accent-foreground));
  }
  .bg-destructive {
    background-color: hsl(var(--destructive));
  }
  .text-destructive-foreground {
    color: hsl(var(--destructive-foreground));
  }

  /* Border & Input */
  .border-border {
    border-color: hsl(var(--border));
  }
  .bg-input {
    background-color: hsl(var(--input));
  }
  .text-ring {
    color: hsl(var(--ring));
  }

  /* Opacity Variants */
  .bg-muted\/50 {
    background-color: hsl(var(--muted) / 0.5);
  }
  .bg-muted\/30 {
    background-color: hsl(var(--muted) / 0.3);
  }
  .bg-muted\/10 {
    background-color: hsl(var(--muted) / 0.1);
  }
  .bg-primary\/5 {
    background-color: hsl(var(--primary) / 0.05);
  }
  .bg-primary\/90 {
    background-color: hsl(var(--primary) / 0.9);
  }
  .bg-card\/95 {
    background-color: hsl(var(--card) / 0.95);
  }

  /* Text Colors */
  .text-primary {
    color: hsl(var(--primary));
  }
  .text-secondary {
    color: hsl(var(--secondary));
  }
  .text-destructive {
    color: hsl(var(--destructive));
  }

  /* Placeholder */
  .placeholder\:text-muted-foreground::placeholder {
    color: hsl(var(--muted-foreground));
  }
}
```

### üìù Por que isso √© necess√°rio?

shadcn/ui usa CSS variables para temas:
```css
:root {
  --background: 0 0% 100%;
  --foreground: 222.2 84% 4.9%;
  --card: 0 0% 100%;
  /* ... */
}
```

E consome via Tailwind:
```tsx
<div className="bg-background text-foreground" />
```

Mas Tailwind por padr√£o n√£o reconhece essas classes. Precisamos criar as utilities manualmente.

### ‚úÖ Valida√ß√£o
```bash
# Verificar que componentes shadcn/ui n√£o t√™m estilos quebrados
‚úì Dialog renderiza com background correto
‚úì Buttons t√™m cores do tema
‚úì Cards seguem color scheme
```

---

## 9. Mobile Header - Touch Targets

### üêõ Problema
Logo e √≠cones do header mobile eram pequenos demais.

### üìÅ Arquivo
```
client/src/components/sidebar.tsx
```
(O componente `MobileHeader` est√° no mesmo arquivo)

### üîß Solu√ß√£o

#### MUDAN√áA 1: Logo responsivo (linha ~872)

```tsx
<div className="flex items-center min-w-0">
  {/* ‚¨áÔ∏è MUDAN√áA: Logo menor em mobile */}
  <div className="h-10 sm:h-12 w-10 sm:w-12 rounded flex items-center justify-center overflow-hidden flex-shrink-0">
    <img
      src={logoBranca}
      alt="Buscador PXT Logo"
      className="h-full w-full object-contain"
    />
  </div>
</div>
```

**Antes:** `h-12 w-12` fixo
**Depois:** `h-10 w-10` (mobile) ‚Üí `h-12 w-12` (sm+)

#### MUDAN√áA 2: Adicionar badges (linha ~888)

```tsx
<div className="flex items-center space-x-3">
  {/* ‚¨áÔ∏è ADICIONAR: Badges informativos */}
  <TesterHeaderBadge />
  <HeaderSubscriptionBadge showPopover={true} />
  <NotificationBell />
  {/* ... resto */}
</div>
```

#### MUDAN√áA 3: Z-index correto (linha ~860)

```tsx
<header className="lg:hidden bg-card border-b border-border/50 px-4 py-3
  sticky top-0 z-30 flex items-center justify-between backdrop-blur-sm bg-card/95">
```

**Antes:** `z-1`
**Depois:** `z-30`

### ‚úÖ Valida√ß√£o
```bash
# Mobile header (< 1024px):
‚úì Logo vis√≠vel e proporcional
‚úì Badges de status aparecem
‚úì Notifica√ß√µes acess√≠veis
‚úì Menu hamburguer funciona

# Desktop (>= 1024px):
‚úì Header oculto (lg:hidden)
```

---

## üìä Resumo Geral das Corre√ß√µes

### Componentes Afetados:
- ‚úÖ `dialog.tsx` - Overflow corrigido
- ‚úÖ `sheet.tsx` - Safe areas iOS
- ‚úÖ `MobileSearchBar.tsx` - Busca num√©rica inteligente
- ‚úÖ `top-search-bar.tsx` - Expans√£o de n√∫meros desktop
- ‚úÖ `landing.tsx` - Menu mobile completo
- ‚úÖ `sidebar.tsx` - Touch targets e collapsed
- ‚úÖ `dashboard-layout.tsx` - Transi√ß√£o sidebar
- ‚úÖ `index.css` - Utility classes tema
- ‚úÖ Mobile header - Logo e badges

### Padr√µes Aplicados:

#### 1. Responsividade Mobile-First
```tsx
// Padr√£o: mobile-first ‚Üí desktop override
className="max-w-[calc(100vw-2rem)] sm:max-w-lg"
className="p-4 sm:p-6"
className="h-10 sm:h-12"
```

#### 2. Touch Targets (Apple HIG)
```tsx
// Sempre: min-h-[44px] min-w-[44px]
className="min-h-[44px] min-w-[44px] inline-flex items-center justify-center"
```

#### 3. Safe Areas iOS
```css
/* Para elementos fixos top/bottom */
pt-[env(safe-area-inset-top)]
pb-[env(safe-area-inset-bottom)]
```

#### 4. Busca Num√©rica Inteligente
```typescript
// Detector de n√∫meros
const isNumberQuery = /^\d{1,2}$/.test(query.trim());

// Ajustar par√¢metros
const params = {
  limit: isNumberQuery ? '12' : '6',
  ...(isNumberQuery ? {} : { exact: 'true' })
};
```

#### 5. √çcones Responsivos
```tsx
// Collapsed vs expanded
className={`${collapsed ? 'h-5 w-5' : 'h-4 w-4'} transition-all duration-200`}
```

---

## üéØ Checklist de Aplica√ß√£o

Ao aplicar essas corre√ß√µes em outro ambiente, siga esta ordem:

### Fase 1: Componentes Base (Cr√≠tico)
- [ ] `dialog.tsx` - Corrigir overflow mobile
- [ ] `sheet.tsx` - Adicionar safe areas
- [ ] `index.css` - Adicionar utility classes

### Fase 2: Navega√ß√£o (Importante)
- [ ] `sidebar.tsx` - Touch targets e collapsed
- [ ] `dashboard-layout.tsx` - Transi√ß√£o sidebar
- [ ] `landing.tsx` - Menu mobile

### Fase 3: Busca (Feature)
- [ ] `MobileSearchBar.tsx` - Busca num√©rica
- [ ] `top-search-bar.tsx` - Expans√£o desktop

### Fase 4: Refinamentos (Opcional)
- [ ] Mobile header - Logo e badges
- [ ] Outros componentes modais (Popover, AlertDialog, etc)

---

## üß™ Testes Finais

Ap√≥s aplicar todas as corre√ß√µes:

### Viewports para testar:
```
320px  - iPhone SE (mais estreito)
375px  - iPhone 12/13 (mais comum)
390px  - iPhone 14 Pro (atual)
414px  - iPhone 14 Pro Max
768px  - iPad
1024px - Desktop
```

### Checklist de valida√ß√£o:
- [ ] Nenhum modal ultrapassa viewport
- [ ] Todos bot√µes/√≠cones >= 44x44px
- [ ] Buscar "15" mostra todas variantes iPhone 15
- [ ] Menu mobile funciona na landing
- [ ] Sidebar colapsada tem √≠cones grandes
- [ ] Safe areas respeitadas em iOS
- [ ] Sem scroll horizontal em nenhuma tela
- [ ] Transi√ß√µes suaves (300ms)

### Comandos de verifica√ß√£o:
```bash
# TypeScript
npm run check  # ou: npx tsc --noEmit

# Build
npm run build

# Dev
npm run dev
```

---

## üìö Refer√™ncias

### Documenta√ß√£o seguida:
- **Apple HIG:** Minimum touch target 44pt √ó 44pt
- **W3C WCAG:** 2.5.5 Target Size (Level AAA)
- **Tailwind CSS:** Mobile-first breakpoints
- **shadcn/ui:** Component patterns

### CSS Custom Properties (tema):
```css
/* Definidas em index.css */
--background
--foreground
--card
--primary
--secondary
--muted
--accent
--destructive
--border
--input
--ring
```

---

## üö® Avisos Importantes

### N√ÉO fa√ßa:
‚ùå Modificar Radix UI primitives diretamente
‚ùå Usar `any` no TypeScript
‚ùå Ignorar safe areas em iOS
‚ùå Usar `!important` no CSS
‚ùå Quebrar backward compatibility

### SEMPRE fa√ßa:
‚úÖ Testar em m√∫ltiplos viewports
‚úÖ Verificar touch targets >= 44px
‚úÖ Manter TypeScript strict
‚úÖ Usar padr√µes do projeto (Tailwind, shadcn/ui)
‚úÖ Validar build antes de commit

---

## üìû Suporte

Se encontrar problemas ao aplicar:

1. **Verificar depend√™ncias:**
   ```bash
   npm list react react-dom tailwindcss
   ```

2. **Limpar cache:**
   ```bash
   rm -rf node_modules
   npm install
   ```

3. **Verificar vers√µes:**
   - React: 18.3+
   - TypeScript: 5.6+
   - Tailwind: 3.4+

4. **Comparar diffs:**
   ```bash
   git diff <commit-hash> -- client/src/components/ui/dialog.tsx
   ```

---

**Documento criado por:** Claude Code (Anthropic)
**Vers√£o:** 1.0
**√öltima atualiza√ß√£o:** 2025-11-07

---

## üéì Ap√™ndice: Padr√µes de Prompt para IA

Para pedir √† IA do Replit que aplique essas corre√ß√µes:

### Template de Prompt:

```
# TASK: Aplicar corre√ß√µes de layout mobile

## CONTEXTO
Projeto React + TypeScript + Tailwind + shadcn/ui
Refer√™ncia: MOBILE-LAYOUT-FIXES-GUIDE.md

## OBJETIVO
Aplicar todas as corre√ß√µes documentadas na Fase [1/2/3/4]

## INSTRU√á√ïES
1. Ler se√ß√£o [N] do guia
2. Aplicar mudan√ßas exatas no arquivo especificado
3. Manter c√≥digo existente n√£o mencionado
4. Validar TypeScript (npm run check)
5. Confirmar aplica√ß√£o antes de pr√≥xima se√ß√£o

## REQUISITOS
- [ ] Seguir c√≥digo ANTES/DEPOIS exato
- [ ] N√£o modificar outras partes do arquivo
- [ ] Manter imports e exports existentes
- [ ] Testar em viewport 375px

## VALIDA√á√ÉO
[Checklist da se√ß√£o espec√≠fica]
```

---

**FIM DO DOCUMENTO**
